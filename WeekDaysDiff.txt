CASE
	WHEN DAYOFWEEK(START_DATE) > DAYOFWEEK(END_DATE) THEN
		CASE
			WHEN DAYOFWEEK(START_DATE) = 7 THEN
				TIMESTAMPDIFF(SQL_TSI_DAY, START_DATE, END_DATE) - (FLOOR(TIMESTAMPDIFF(SQL_TSI_DAY, START_DATE, END_DATE)/7)*2)-1
			ELSE
				TIMESTAMPDIFF(SQL_TSI_DAY, START_DATE, END_DATE) - (FLOOR(TIMESTAMPDIFF(SQL_TSI_DAY, START_DATE, END_DATE)/7)*2)-2
		END
	ELSE
		TIMESTAMPDIFF(SQL_TSI_DAY, START_DATE, END_DATE) - (FLOOR(TIMESTAMPDIFF(SQL_TSI_DAY, START_DATE, END_DATE)/7)*2)
END
